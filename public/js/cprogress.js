(function(a){if(!a.ns){a.ns={}}a.ns.cprogress=function(b,c){var d=this;d.$el=a(b);d.el=b;d.$el.data("ns.cprogress",d);d.options=a.extend({},a.ns.cprogress.defaultOptions,c);d.methods={init:function(){d.img1=new Image;d.img1.src=d.options.img1;d.img2=new Image;d.img2.src=d.options.img2;d.width=d.img1.width;d.height=d.img1.height;d.$progress=a("<div />").addClass("jCProgress");mt=parseInt(d.$progress.css("marginTop").replace("ems",""));ml=parseInt(d.$progress.css("marginLeft").replace("ems",""));d.$progress.css("marginLeft",(d.$el.width()-d.width)/2+ml).css("marginTop",(d.$el.height()-d.height)/2+mt).css("opacity","0.0");d.$percent=a("<div />").addClass("percent");d.$ctx=a("<canvas />");d.$ctx.attr("width",d.width);d.$ctx.attr("height",d.height);d.$el.prepend(d.$progress);d.$progress.append(d.$percent);d.$progress.append(d.$ctx);d.$progress.animate({opacity:1},500,function(){});d.ctx=d.$ctx[0].getContext("2d");d.ctx.fillStyle="rgba(0,0,0,0.0)";d.i=0;d.j=0;d.stop=0;d.options.onInit();d.methods.draw()},reloadImages:function(){d.img1=new Image;d.img1.src=d.options.img1;d.img2=new Image;d.img2.src=d.options.img2;d.width=d.img1.width;d.height=d.img1.height;d.$progress.css("marginLeft",(d.$el.width()-d.width)/2+ml).css("marginTop",(d.$el.height()-d.height)/2+mt);d.$ctx.attr("width",d.width);d.$ctx.attr("height",d.height);d.ctx=d.$ctx[0].getContext("2d");d.ctx.fillStyle="rgba(0,0,0,0.0)"},coreDraw:function(){d.ctx.clearRect(0,0,d.width,d.height);d.ctx.save();d.ctx.drawImage(d.img1,0,0);d.ctx.beginPath();d.ctx.lineWidth=5;d.ctx.arc(d.width/2,d.height/2,d.height/2,d.i-Math.PI/2,d.j-Math.PI/2,true);d.ctx.lineTo(d.width/2,d.height/2);d.ctx.closePath();d.ctx.fill();d.ctx.clip();d.ctx.drawImage(d.img2,0,0);d.ctx.restore()},draw:function(){if(d){if(d.width==0||d.height==0){d.methods.reloadImages()}if(d.options.showPercent==false){d.$percent.hide()}else{d.$percent.show()}if(d.stop!=1&&d.options.percent-1<=d.options.limit){if(d.options.loop==true){d.options.limit=121}if(d.options.percent>=100&&d.options.percent<=d.options.limit){d.i=0;d.options.limit=d.options.limit-100}d.methods.coreDraw();d.i=d.i+d.options.PIStep;d.options.percent=d.i*100/(Math.PI*2);if(d.options.percent<=d.options.limit){setTimeout(d.methods.draw,d.options.speed);d.$percent.html(d.options.percent.toFixed(0));d.options.onProgress(d.options.percent.toFixed(0))}else{d.$percent.html(d.options.limit);d.methods.coreDraw();d.options.onProgress(d.options.limit);d.options.onComplete(d.options.limit)}d.options.percent++}}},destroy:function(){d.$progress.animate({opacity:0},500,function(){d.$progress.remove();d.stop=1;d=null})}};d.public_methods={start:function(){d.stop=0;d.methods.draw()},stop:function(){d.stop=1},reset:function(){d.options.percent=0;d.i=0;d.methods.draw()},destroy:function(){d.methods.destroy()},options:function(b){d.options=a.extend({},d.options,b);if(b.img1||b.img2||b.img3){d.methods.reloadImages();d.methods.coreDraw()}d.methods.draw();return d.options}};d.methods.init()};a.ns.cprogress.defaultOptions={percent:0,img1:"v1.png",img2:"v2.png",speed:50,limit:48,loop:false,showPercent:true,PIStep:.05,onInit:function(){},onProgress:function(a){},onComplete:function(){}};a.fn.cprogress=function(b){var c=new a.ns.cprogress(this,b);return c.public_methods}})(jQuery);